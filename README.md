						      图书借阅管理系统需求分析

1. 系统启动
     图书交换管理系统启动后, 建立于MySQL数据库的连接.

2.用户注册
    注册新用户时,用户需设置一个唯一的用户名和密码.另外,注册用户时还需要用户登记其邮箱及电话和地址信息. 如果注册时提供的用户名已由其他用户使用,应反馈一个适当的出错信息. 同时注册用户需要提供5本书或5本以上的书来与供其他用户借阅. 成功注册后, 也应该反馈一个成功注册的信息.

3.用户登陆
   用户使用用户名和密码登陆图书交换管理系统. 用户名和密码同时正确则登陆成功并反馈一个成功登陆的信息. 否则, 登陆失败并反馈一个失败登陆的信息.

4. 用户删除
    已登陆用户可以注销用户账户. 用户注销操作成功, 需反馈一个成功注销的信息; 否则, 用户注销失败并需反馈一个失败注销的信息. 注销成功并退出系统登陆状态. 用户注销后, 该用户账户不再存在.
    条件: 当前用户没有未还的书籍且没有借出去的书籍, 该用户才能被删除.

5. 用户退出
    已登陆的用户退出图书交换管理系统后不再执行用户删除, 退出, 查询, 借阅书籍, 查询书籍, 删除已还书籍的借书记录和被其他用户借书已还的记录, 清除所有与自己相关且已完成的借书记录的操作.
系统只运行用户注册和用户登陆.

6. 用户查询
    用户可以查看已注册该系统的所有用户的用户名, 邮箱, 电话及地址信息.

7. 用户资金充值
   已登陆用户可以为自己的账户充值资金, 从而用于借阅时的抵押.

8. 图书查找
    用户可以根据书名,  在所有用户共享的图书中搜索, 查找自己想借的图书信息, 图书信息包括: 图书名字, 作者, 图书所有者, 是否已借出.

9. 图书借阅
    已登陆用户可以向图书所有者发起一条图书借阅申请. 规定图书借阅只能在两个已注册用户间举行. 借阅申请的信息包括:
      图书名字(title)
      图书借阅者(borrower)
      图书所有者(owner)
      图书押金(v_price)
      图书借阅时间(time)
其中, 图书押金为从借阅者账户资金中扣取, 用于防止借阅者过期后, 未归还图书给所有者, 则将该押金打给所有者, 用以赔偿, 押金金额由所有者设定, 由系统作为中介保管. 

10. 图书借阅记录查询
     已登陆用户可以查询自己的图书借阅记录, 其中记录包括自己作为借阅者和作为所有者的借阅记录.

11. 图书归还
     已登陆用户, 可以归还自己借阅的图书, 此时修改对应的图书借阅记录为已归还, 等待图书所有者确认. 同时, 当前用户也可以在收到其他用户归还的图书时, 确认图书借阅完成, 此时系统将押金打回给借阅者, 图书借阅完成. 

12. 图书借阅记录删除
      已登陆用户可以删除与自己相关的已完成的图书借阅记录, 包括自己作为借阅者和所有者的借阅记录.

13. 系统退出
   关闭与MySQL的连接.

			增加图书交流社区功能: 
用户与服务器端的连接使用的是tcp通信, 用户与用户之间的私聊, 群聊使用的是udp通信.

首先服务器启动, 创建tcp套接口和udp套接口, 其中tcp套接口用于接收用户端的tcp连接.
tcp通信包括:
1. 接收新用户连接, 同时在服务器本地维护的在线用户列表中添加该用户信息(用户名, 其udp套接口ip地址, 其udp端口号, 其tcp套接口用户端不关心, 设为默认-1).
2. 服务器在接收到某用户查询在线用户请求时, 发送所有在线用户列表(用户信息)给用户, 该用户同时在本地维护的在线用户列表中添加用户信息; 
3. 新用户登陆时, 提示其他用户有新用户登陆,同时每个用户的本地在线用户列表中添加该用户信息用于之后的udp私聊和群聊;在之后在用户信息中添加用户的tcp套接口, 用于服务器端的在用户下线时,通过该tcp套接口在在线用户列表中删除下线用户.
4. 某用户下线时, 提示所有其他用户有用户下线, 同时每个用户在本地维护的在线用户列表中删除该用户和其信息.
5. 服务器端在处理以上任务时会创建一个新的线程来处理,使用多线程的方式处理多个客户端的并发请求.

udp通信包括:
1. 服务器端维护一个udp套接口用于接收用户发送过来的udp包, 用户发送udp包过来的主要目的是:在服务器端获得该用户的udp套接口的ip地址和端口号,保存为用户信息,在自己用户查询在线用户时, 发送给该用户, 使其获得其他用户的udp套接口地址, 从而进行通过udp实现私聊和群聊
2. 用户端套接口用于接收其他用户发送过来的udp实现的私聊信息和群聊信息
3. 群聊实现为通过发起群聊的用户向所有其他在线用户发送udp包来实现, 私聊则为发起私聊的用户只发送给它希望私聊的用户udp包来实现.


运行方式:
首先进入chatSpace目录运行服务器server启动服务器, 然后进入bookSearch目录运行main即可登陆图书借阅管理系统, 若需访问成功,还需进行mysql数据库方面的配置.

